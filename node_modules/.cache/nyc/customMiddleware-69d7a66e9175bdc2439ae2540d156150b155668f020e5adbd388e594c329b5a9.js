function cov_2c5i1ua3v0(){var path="/Users/jeonhyeonseong/Documents/express-mysql-example/src/customMiddleware.js";var hash="a110da293908ef253115762a621dc5c2b5a79c7a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/jeonhyeonseong/Documents/express-mysql-example/src/customMiddleware.js",statementMap:{"0":{start:{line:1,column:20},end:{line:1,column:49}},"1":{start:{line:2,column:20},end:{line:2,column:44}},"2":{start:{line:4,column:13},end:{line:4,column:22}},"3":{start:{line:6,column:28},end:{line:16,column:1}},"4":{start:{line:7,column:2},end:{line:15,column:3}},"5":{start:{line:8,column:15},end:{line:8,column:61}},"6":{start:{line:8,column:56},end:{line:8,column:60}},"7":{start:{line:9,column:4},end:{line:9,column:20}},"8":{start:{line:10,column:4},end:{line:10,column:17}},"9":{start:{line:12,column:4},end:{line:12,column:71}},"10":{start:{line:14,column:4},end:{line:14,column:19}},"11":{start:{line:18,column:27},end:{line:31,column:1}},"12":{start:{line:19,column:2},end:{line:30,column:3}},"13":{start:{line:20,column:4},end:{line:23,column:7}},"14":{start:{line:25,column:4},end:{line:25,column:23}},"15":{start:{line:26,column:4},end:{line:29,column:7}},"16":{start:{line:33,column:0},end:{line:36,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:28},end:{line:6,column:29}},loc:{start:{line:6,column:54},end:{line:16,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:40},end:{line:8,column:41}},loc:{start:{line:8,column:56},end:{line:8,column:60}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:18,column:27},end:{line:18,column:28}},loc:{start:{line:18,column:52},end:{line:31,column:1}},line:18}},branchMap:{"0":{loc:{start:{line:19,column:2},end:{line:30,column:3}},type:"if",locations:[{start:{line:19,column:2},end:{line:30,column:3}},{start:{line:19,column:2},end:{line:30,column:3}}],line:19}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"a110da293908ef253115762a621dc5c2b5a79c7a"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2c5i1ua3v0=function(){return actualCoverage;};}return actualCoverage;}cov_2c5i1ua3v0();const{getPool}=(cov_2c5i1ua3v0().s[0]++,require("../config/database"));const CustomError=(cov_2c5i1ua3v0().s[1]++,require("./customError"));const pool=(cov_2c5i1ua3v0().s[2]++,getPool());cov_2c5i1ua3v0().s[3]++;const dbConnectionHandler=async(req,res,next)=>{cov_2c5i1ua3v0().f[0]++;cov_2c5i1ua3v0().s[4]++;try{var conn=(cov_2c5i1ua3v0().s[5]++,await pool.getConnection(async conn=>{cov_2c5i1ua3v0().f[1]++;cov_2c5i1ua3v0().s[6]++;return conn;}));cov_2c5i1ua3v0().s[7]++;res.conn=conn;cov_2c5i1ua3v0().s[8]++;await next();}catch(err){cov_2c5i1ua3v0().s[9]++;return next(new CustomError("DB_ERROR",500,"DB Error Occured."));}finally{cov_2c5i1ua3v0().s[10]++;conn.release();}};cov_2c5i1ua3v0().s[11]++;const serverErrorHandler=(err,req,res,next)=>{cov_2c5i1ua3v0().f[2]++;cov_2c5i1ua3v0().s[12]++;if(err instanceof CustomError){cov_2c5i1ua3v0().b[0][0]++;cov_2c5i1ua3v0().s[13]++;return res.status(err.status).send({error:err.code,description:err.message});}else{cov_2c5i1ua3v0().b[0][1]++;cov_2c5i1ua3v0().s[14]++;console.error(err);cov_2c5i1ua3v0().s[15]++;return res.status(500).send({error:"GENERIC",description:"Something went wrong. Please try again or contact support."});}};cov_2c5i1ua3v0().s[16]++;module.exports={serverErrorHandler,dbConnectionHandler};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbU1pZGRsZXdhcmUuanMiXSwibmFtZXMiOlsiZ2V0UG9vbCIsInJlcXVpcmUiLCJDdXN0b21FcnJvciIsInBvb2wiLCJkYkNvbm5lY3Rpb25IYW5kbGVyIiwicmVxIiwicmVzIiwibmV4dCIsImNvbm4iLCJnZXRDb25uZWN0aW9uIiwiZXJyIiwicmVsZWFzZSIsInNlcnZlckVycm9ySGFuZGxlciIsInN0YXR1cyIsInNlbmQiLCJlcnJvciIsImNvZGUiLCJkZXNjcmlwdGlvbiIsIm1lc3NhZ2UiLCJjb25zb2xlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjR4RUFlWTsyRkFmWixLQUFNLENBQUVBLE9BQUYsMkJBQWNDLE9BQU8sQ0FBQyxvQkFBRCxDQUFyQixDQUFOLENBQ0EsS0FBTUMsQ0FBQUEsV0FBVywwQkFBR0QsT0FBTyxDQUFDLGVBQUQsQ0FBVixDQUFqQixDQUVBLEtBQU1FLENBQUFBLElBQUksMEJBQUdILE9BQU8sRUFBVixDQUFWLEMsd0JBRUEsS0FBTUksQ0FBQUEsbUJBQW1CLENBQUcsTUFBT0MsR0FBUCxDQUFZQyxHQUFaLENBQWlCQyxJQUFqQixHQUEwQixpREFDcEQsR0FBSSxDQUNGLEdBQUlDLENBQUFBLElBQUksMEJBQUcsS0FBTUwsQ0FBQUEsSUFBSSxDQUFDTSxhQUFMLENBQW1CLEtBQU9ELENBQUFBLElBQVAsRUFBZ0JBLHVEQUFBQSxDQUFBQSxJQUFJLEVBQXZDLENBQVQsQ0FBUixDQURFLHdCQUVGRixHQUFHLENBQUNFLElBQUosQ0FBV0EsSUFBWCxDQUZFLHdCQUdGLEtBQU1ELENBQUFBLElBQUksRUFBVixDQUNELENBQUMsTUFBT0csR0FBUCxDQUFZLHlCQUNaLE1BQU9ILENBQUFBLElBQUksQ0FBQyxHQUFJTCxDQUFBQSxXQUFKLENBQWdCLFVBQWhCLENBQTRCLEdBQTVCLENBQWlDLG1CQUFqQyxDQUFELENBQVgsQ0FDRCxDQU5ELE9BTVUsMEJBQ1JNLElBQUksQ0FBQ0csT0FBTCxHQUNELENBQ0YsQ0FWRCxDLHlCQVlBLEtBQU1DLENBQUFBLGtCQUFrQixDQUFHLENBQUNGLEdBQUQsQ0FBTUwsR0FBTixDQUFXQyxHQUFYLENBQWdCQyxJQUFoQixHQUF5QixrREFDbEQsR0FBSUcsR0FBRyxXQUFZUixDQUFBQSxXQUFuQixDQUFnQyxxREFDOUIsTUFBT0ksQ0FBQUEsR0FBRyxDQUFDTyxNQUFKLENBQVdILEdBQUcsQ0FBQ0csTUFBZixFQUF1QkMsSUFBdkIsQ0FBNEIsQ0FDakNDLEtBQUssQ0FBRUwsR0FBRyxDQUFDTSxJQURzQixDQUVqQ0MsV0FBVyxDQUFFUCxHQUFHLENBQUNRLE9BRmdCLENBQTVCLENBQVAsQ0FJRCxDQUxELElBS08scURBQ0xDLE9BQU8sQ0FBQ0osS0FBUixDQUFjTCxHQUFkLEVBREsseUJBRUwsTUFBT0osQ0FBQUEsR0FBRyxDQUFDTyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsQ0FDMUJDLEtBQUssQ0FBRSxTQURtQixDQUUxQkUsV0FBVyxDQUFFLDREQUZhLENBQXJCLENBQVAsQ0FJRCxDQUNGLENBYkQsQyx5QkFlQUcsTUFBTSxDQUFDQyxPQUFQLENBQWlCLENBQ2ZULGtCQURlLENBRWZSLG1CQUZlLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBnZXRQb29sIH0gPSByZXF1aXJlKFwiLi4vY29uZmlnL2RhdGFiYXNlXCIpO1xuY29uc3QgQ3VzdG9tRXJyb3IgPSByZXF1aXJlKFwiLi9jdXN0b21FcnJvclwiKTtcblxuY29uc3QgcG9vbCA9IGdldFBvb2woKTtcblxuY29uc3QgZGJDb25uZWN0aW9uSGFuZGxlciA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIHZhciBjb25uID0gYXdhaXQgcG9vbC5nZXRDb25uZWN0aW9uKGFzeW5jIChjb25uKSA9PiBjb25uKTtcbiAgICByZXMuY29ubiA9IGNvbm47XG4gICAgYXdhaXQgbmV4dCgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV4dChuZXcgQ3VzdG9tRXJyb3IoXCJEQl9FUlJPUlwiLCA1MDAsIFwiREIgRXJyb3IgT2NjdXJlZC5cIikpO1xuICB9IGZpbmFsbHkge1xuICAgIGNvbm4ucmVsZWFzZSgpO1xuICB9XG59O1xuXG5jb25zdCBzZXJ2ZXJFcnJvckhhbmRsZXIgPSAoZXJyLCByZXEsIHJlcywgbmV4dCkgPT4ge1xuICBpZiAoZXJyIGluc3RhbmNlb2YgQ3VzdG9tRXJyb3IpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyhlcnIuc3RhdHVzKS5zZW5kKHtcbiAgICAgIGVycm9yOiBlcnIuY29kZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBlcnIubWVzc2FnZSxcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHtcbiAgICAgIGVycm9yOiBcIkdFTkVSSUNcIixcbiAgICAgIGRlc2NyaXB0aW9uOiBcIlNvbWV0aGluZyB3ZW50IHdyb25nLiBQbGVhc2UgdHJ5IGFnYWluIG9yIGNvbnRhY3Qgc3VwcG9ydC5cIixcbiAgICB9KTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNlcnZlckVycm9ySGFuZGxlcixcbiAgZGJDb25uZWN0aW9uSGFuZGxlcixcbn07XG4iXX0=